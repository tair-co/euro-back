<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{workspace.title}}</title>
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css" />
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>
  <body>
    <div class="workspace">
      <h1>Workspace of <em class=" text-primary">{{workspace.title}}</em></h1>
      <p>{{description}}</p>
      <h3 class=" mt-5">API Tokens</h3>
      <form action="/v1/api/workspaces/{{workspace.id}}/tokens/create" method="post" class=" mb-4">
        <div class="input-group">
          <input type="text" name="name" class="form-control" placeholder="Token Name"  />
          <button type="submit" style="margin-left: 5px;" class="btn btn-primary">Create Token</button>
        </div>
        {{#if message}}
        <p class="text-danger mt-3">{{message}}</p>
        {{/if}} 
      </form>
      <table class="table table-striped">
        <tr>
          <th>Name</th>
          <th>Token</th>
          <th>Created At</th>
          <th>Revocation date</th>
          <th>Actions</th>
        </tr>

        {{#each workspace.tokens}}

        <tr>
          <td>{{this.name}}</td>
          <td>****</td>
          <td>{{this.createdAt}}</td>
            {{#if this.revocationDate}}
            <td>{{this.revocationDate}}</td>
                {{else}}
            <td class="text-muted">Not Revoked</td>
            {{/if}}
            {{#if this.revocationDate}}
            <td><button class="btn btn-secondary" disabled>Revoked</button></td>
            {{else}}
          <td><a href="/v1/api/workspaces/tokens/{{this.id}}/revoke" class="btn btn-danger text-light">Revoke</a></td>
            {{/if}}
        </tr>
     {{/each}}
     {{#unless workspace.tokens.length}}
        <tr>
          <td colspan="5" class="text-center">No tokens found</td>
        </tr>
        {{/unless}}
      </table>
      <h3 class=" mt-5">Workspace Billing Quotas</h3>
      <form method="post" action="/v1/api/workspaces/{{workspace.id}}/quotas/create">
        <div class="input-group mb-3">
          <input type="number" name="limit" class="form-control" placeholder="Set Billing Quota" value="{{workspace.billingQuota}}" />
          <button type="submit" style="margin-left: 5px;" class="btn btn-success">Update Quota</button>
        </div>
        {{#if messageQuota}}
        <p class="text-danger mt-3">{{messageQuota}}</p>
        {{/if}}
      </form>
      <p class=" mt-3">Current Usage: 0</p>
      <p>Max Limit: {{#if quota}} {{quota.limit}} dollars {{else}} Within Limits {{/if}}</p>
      <p>Number of remaining days: {{#if quota}} {{remainingDays}} {{else}} N/A {{/if}}</p>
      {{#if quota}} <a class="btn btn-danger" href="/v1/api/workspaces/quotas/{{quota.id}}/remove">Remove Quota</a> {{else}} <button class="btn btn-danger" disabled>Remove Quota</button>{{/if}}
    <a class="btn btn-primary d-flex mt-5" style="align-self:flex-start" href="/v1/workspaces/{{workspace.id}}/billing">View bill</a>
    </div>
    <script>
        if(`{{{token}}}`.length > 90) {
            alert("Token: {{{token}}}");
            window.location.href = "/v1/workspace/{{{workspace.id}}}";
        }
    </script>
  </body>

</html>